<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Mes présences</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
<div class="container py-5">
    <h1 class="mb-4 text-center">Mes présences - {{ username }}</h1>

    <form method="get" class="row g-2 mb-3">
    <div class="col-auto">
        <input type="month" name="mois" class="form-control" value="{{ mois_selectionne|default('') }}">
    </div>
    <div class="col-auto">
        <button class="btn btn-primary" type="submit">Filtrer</button>
    </div>
</form>

    <table class="table table-bordered table-striped">
        <thead class="table-dark">
            <tr>
                <th>Date</th>
                <th>Présence</th>
            </tr>
        </thead>
        <tbody>
            {% for d, p in presences %}
            <tr>
                <td>{{ d }}</td>
                <td>{{ p }}</td>
            </tr>
            {% else %}
            <tr>
                <td colspan="2" class="text-center">Aucune donnée trouvée</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <a href="{{ url_for('logout') }}" class="btn btn-danger">Déconnexion</a>
    <a href="/" class="btn btn-secondary">Retour à l'accueil</a>
</div>
</div>
     </div>
</div>
<footer class="copyright text-center">
    &copy; RAKOTONAIVO Solofojaona roberto 2025
</footer>
<style>
    .copyright {
        color: #888;
        font-size: 0.95rem;
        text-align: center;
        position: fixed;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(255,255,255,0.85);
        padding: 8px 0 6px 0;
        z-index: 100;
        margin: 0;
    }
</style>
<script>
let sessionTimeout;
const SESSION_DELAY = 10 * 60 * 1000; // 10 minutes en ms

function resetSessionTimer() {
    clearTimeout(sessionTimeout);
    sessionTimeout = setTimeout(() => {
        window.location.href = "/logout";
    }, SESSION_DELAY);
}

// Réinitialise le timer sur toute activité utilisateur
['click', 'mousemove', 'keydown', 'scroll', 'touchstart'].forEach(evt =>
    document.addEventListener(evt, resetSessionTimer)
);

resetSessionTimer();
</script>
</body>
</html>
